'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _cloneDeep = require('lodash/cloneDeep');

var _cloneDeep2 = _interopRequireDefault(_cloneDeep);

var _reduce = require('lodash/reduce');

var _reduce2 = _interopRequireDefault(_reduce);

var _noop = require('lodash/noop');

var _noop2 = _interopRequireDefault(_noop);

var _cleanProps = require('./cleanProps');

var _cleanProps2 = _interopRequireDefault(_cleanProps);

var _MapHelpers = require('./MapHelpers');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var makeCircle = function makeCircle(props) {
  var p = (0, _cloneDeep2.default)(props);
  if (!props.newCircleRadius || !props.newCircleCenter) return;
  var features = props.features;

  var circApprox = (0, _MapHelpers.generateCircleApprox)(props.newCircleRadius, props.unit, props.newCircleCenter, 24);
  if (circApprox.properties.area > props.maxAreaEach) {
    circApprox.properties.tooLarge = true;
  }
  p.features.push(circApprox);
  p.totalArea = (0, _reduce2.default)(features, _MapHelpers.areaAccumulator, 0);
  p.makeCircleOn = false;
  p.newCircleRadius = 0.1;
  (0, _cleanProps2.default)(p, props.onShapeChange, _noop2.default);
};

exports.default = makeCircle;